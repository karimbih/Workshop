<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Mission Gaïa – Équipe {{ room_code }}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
</head>
<body>
<header>
  <h2>Équipe {{ room_code }}</h2>
  <div id="timer">⏳ 03:00</div>
  <div style="display:flex; gap:8px; align-items:center;">
    <button id="startBtn" type="button" disabled>Démarrer</button>
  </div>
</header>

<main>
  <section id="prompt"></section>
  <section id="actions">
    <div id="formArea"></div>
    <button id="submitBtn" type="button" disabled>Valider</button>
  </section>

  <aside id="chat">
    <div style="margin-bottom:8px; font-size:14px; opacity:.8;">
      Codes joueurs (à distribuer) :
      <code>{% for p in players %}{{p.code}}{% if not loop.last %}, {% endif %}{% endfor %}</code>
    </div>
    <div id="authBox" style="display:flex; gap:6px; margin-bottom:8px;">
      <input id="playerName" placeholder="Ton pseudo">
      <input id="playerCode" placeholder="Ton code joueur (ex: A1B2C3)">
      <button id="authBtn" type="button">Se connecter</button>
    </div>
    <div id="chatLog"></div>
    <div style="display:flex; gap:6px; margin-top:8px;">
      <input id="chatInput" placeholder="Écrire un message pour l'équipe…" disabled />
      <button id="chatSend" type="button" disabled>Envoyer</button>
    </div>
  </aside>
</main>

<script>const ROOM = "{{ room_code }}";</script>
<script src="{{ url_for('static', filename='client.js') }}?v=7"></script>
<!-- Popup temps écoulé -->
<div id="timeoutModal" style="
    display:none;
    position:fixed;
    top:0; left:0;
    width:100%; height:100%;
    background:rgba(0,0,0,0.8); /* fond semi-transparent noir /
    justify-content:center;
    align-items:center;
    z-index:1000;
">
  <div style="
      background:#111;            / fond noir profond /
      color:#fff;                 / texte blanc */
      padding:20px 30px;
      border-radius:10px;
      text-align:center;
      max-width:400px;
      width:90%;
      box-shadow:0 0 10px #000;
  ">
    <h2>⏰ Temps écoulé !</h2>
    <p>La partie est terminée, vous pouvez plus sauver la planéte.</p>
  </div>
</div>

<!-- Popup de contexte du jeu -->
<div id="contextModal" style="
  display:none;
  position:fixed;
  top:0; left:0;
  width:100%; height:100%;
  background:rgba(0,0,0,0.85);
  justify-content:center;
  align-items:center;
  z-index:1000;
">
  <div style="
    background:#111;
    color:#fff;
    padding:25px 30px;
    border-radius:12px;
    text-align:center;
    max-width:600px;
    width:90%;
    box-shadow:0 0 15px rgba(0,0,0,0.8);
    font-family:sans-serif;
  ">
    <h2 style="color:#00ff99;">🌍 Mission Gaïa</h2>
    <p style="font-size:15px; line-height:1.6; margin-top:10px;">
      Bienvenue, agent&nbsp;!
      Votre mission est de restaurer l’équilibre écologique de la planète.
      Vous devrez résoudre plusieurs épreuves&nbsp;: tri des déchets, gestion d’énergie propre, énigmes et décisions environnementales cruciales.
      Chaque seconde compte, alors travaillez en équipe et sauvez la planète avant qu’il ne soit trop tard !
    </p>
    <button id="closeContext" style="
      margin-top:20px;
      padding:10px 20px;
      border:none;
      border-radius:8px;
      background:#00ff99;
      color:#000;
      font-weight:bold;
      font-size:16px;
      cursor:pointer;
      transition:0.3s;
    ">Commencer la mission 🚀</button>
  </div>
</div>

</body>
</html>

